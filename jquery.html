<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo App (jQuery)</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <h1>Todo App â€“ jQuery</h1>
    <input type="text" id="new-todo" placeholder="Tulis todo..." />
    <button id="add-btn">Tambah</button>

    <ul id="todo-list"></ul>

    <script>
        const API_URL = "https://todopweb.fana.my.id/todos";

        function loadTodos() {
            $.get(API_URL, function (data) {
                $("#todo-list").empty();
                data.forEach(todo => {
                    $("#todo-list").append(`
            <li>
              <span style="text-decoration:${todo.completed ? 'line-through' : 'none'}">
                ${todo.title}
              </span>
              <button onclick="toggleTodo(${todo.id}, ${!todo.completed})">
                ${todo.completed ? "Undo" : "Done"}
              </button>
              <button onclick="deleteTodo(${todo.id})">Hapus</button>
            </li>
          `);
                });
            });
        }

        function addTodo() {
            const title = $("#new-todo").val();
            if (!title) return alert("Tulis dulu todo!");
            $.ajax({
                url: API_URL,
                method: "POST",
                contentType: "application/json",
                data: JSON.stringify({ title }),
                success: () => {
                    $("#new-todo").val("");
                    loadTodos();
                }
            });
        }

        function toggleTodo(id, completed) {
            $.ajax({
                url: `${API_URL}/${id}`,
                method: "PUT",
                contentType: "application/json",
                data: JSON.stringify({ completed }),
                success: loadTodos
            });
        }

        function deleteTodo(id) {
            $.ajax({ url: `${API_URL}/${id}`, method: "DELETE", success: loadTodos });
        }

        $("#add-btn").click(addTodo);
        $(document).ready(loadTodos);
    </script>
</body>

</html>